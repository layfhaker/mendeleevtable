/* =========================================
   BASE.CSS — Базовые стили страницы (ИСПРАВЛЕНО)
   ========================================= */

/* --- Safe Area переменные для iPhone notch --- */
/* =========================================
   BASE.CSS — Базовые стили страницы
   ========================================= */

/* --- Safe Area переменные --- */
:root {
    --sat: env(safe-area-inset-top, 0px);
    --sab: env(safe-area-inset-bottom, 0px);
    --sal: env(safe-area-inset-left, 0px);
    --sar: env(safe-area-inset-right, 0px);

    /* Light theme scrollbar */
    --scrollbar-width: 8px;
    --scrollbar-thumb: #2196F3;
    --scrollbar-thumb-hover: #1976D2;
    --scrollbar-track: rgba(0, 0, 0, 0.05);
    --scrollbar-radius: 4px;

    /* FlipModalAnimator timings */
    --flip-move-ms: 360ms;
    --flip-radius-ms: 360ms;
    --flip-backdrop-ms: 260ms;
    --flip-ease: cubic-bezier(0.2, 0.0, 0.0, 1);
    --flip-backdrop-ease: cubic-bezier(0.2, 0.0, 0.0, 1);
}

body.dark-theme {
    /* Dark theme scrollbar */
    --scrollbar-thumb: #64B5F6;
    --scrollbar-thumb-hover: #90CAF9;
    --scrollbar-track: rgba(255, 255, 255, 0.05);
}

/* 1. ПЕРЕНОСИМ ФОН СЮДА */
html {
    background-color: #f0f0f0; /* Красим "подложку" всего браузера */
    height: 100%;
}

/* --- Основные стили body --- */
body {
    font-family: Arial, sans-serif;
    /* background-color: #f0f0f0;  <-- УБИРАЕМ ОТСЮДА или оставляем (не мешает) */
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    min-height: 100vh;      
    height: auto;           
    margin: 0;
    padding: 20px;          
    overflow-y: auto;       
    overflow-x: hidden;      /* Лучше hidden для десктопа, если нет таблицы */
    box-sizing: border-box;
}

/* =========================================
   АДАПТИВ
   ========================================= */
@media (max-width: 1024px) {

    html, body {
        width: 100%;
        margin: 0;
        padding: 0;
        overflow-x: auto; 
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        /* Гарантируем, что фон на мобильных тоже серый */
        background-color: #f0f0f0; 
    }

    body {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        
        /* ВАЖНО: Добавляем var(--sab) к нижнему отступу */
        /* Убираем боковые отступы на мобилках, оставляем safe-area */
        padding: 10px calc(0px + var(--sal)) calc(20px + var(--sab)) calc(0px + var(--sar)) !important; 
        
        box-sizing: border-box;
    }

}

/* --- Canvas для частиц --- */
#particles-canvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
    pointer-events: none;
}



/* =========================================
   АДАПТИВ
   ========================================= */
 @media (max-width: 1024px) {

    /* Скрываем полосу прокрутки */
    body::-webkit-scrollbar {
        display: none;
    }

    body {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }
}
/* Кастомный скроллбар для десктопной версии */
@media (min-width: 1025px) {
    body::-webkit-scrollbar {
        width: 12px;
    }

    body::-webkit-scrollbar-track {
        background: #f0f0f0;
    }

    body::-webkit-scrollbar-thumb {
        background: linear-gradient(135deg, #2196F3, #21CBF3);
        border-radius: 10px;
        border: 2px solid #f0f0f0;
    }

    body::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(135deg, #1976D2, #0BB3F3);
    }

    body {
        scrollbar-width: thin;
        scrollbar-color: #2196F3 #f0f0f0;
    }
}

/* Универсальные стили скроллбара */
/* Firefox */
* {
    scrollbar-width: thin;
    scrollbar-color: #2196F3 rgba(0, 0, 0, 0.05);
}

/* Chrome/Safari/Edge - используем прямые значения вместо переменных */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.05);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb {
    background: linear-gradient(135deg, #2196F3, #64B5F6);
    border-radius: 4px;
    border: 2px solid transparent;
    background-clip: padding-box;
}

::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(135deg, #1976D2, #2196F3);
    background-clip: padding-box;
}

::-webkit-scrollbar-corner {
    background: transparent;
}

/* Тёмная тема - глобальные скроллбары */
body.dark-theme * {
    scrollbar-color: #64B5F6 rgba(255, 255, 255, 0.05);
}

body.dark-theme ::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
}

body.dark-theme ::-webkit-scrollbar-thumb {
    background: linear-gradient(135deg, #64B5F6, #90CAF9);
}

body.dark-theme ::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(135deg, #42A5F5, #64B5F6);
}

/* =========================================
   Панорамные подсказки (градиенты)
   ========================================= */
.pan-hints {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 5;
}

.pan-hint {
    position: absolute;
    opacity: 0;
    transition: opacity 200ms ease;
}

.pan-hint.is-visible {
    opacity: 1;
}

.pan-hint--left,
.pan-hint--right {
    top: 0;
    bottom: 0;
    width: 36px;
}

.pan-hint--top,
.pan-hint--bottom {
    left: 0;
    right: 0;
    height: 28px;
}

.pan-hint--left {
    left: 0;
    background: linear-gradient(90deg, rgba(240, 240, 240, 0.9), rgba(240, 240, 240, 0));
}

.pan-hint--right {
    right: 0;
    background: linear-gradient(270deg, rgba(240, 240, 240, 0.9), rgba(240, 240, 240, 0));
}

.pan-hint--top {
    top: 0;
    background: linear-gradient(180deg, rgba(240, 240, 240, 0.9), rgba(240, 240, 240, 0));
}

.pan-hint--bottom {
    bottom: 0;
    background: linear-gradient(0deg, rgba(240, 240, 240, 0.9), rgba(240, 240, 240, 0));
}

body.dark-theme .pan-hint--left {
    background: linear-gradient(90deg, rgba(15, 15, 15, 0.9), rgba(15, 15, 15, 0));
}

body.dark-theme .pan-hint--right {
    background: linear-gradient(270deg, rgba(15, 15, 15, 0.9), rgba(15, 15, 15, 0));
}

body.dark-theme .pan-hint--top {
    background: linear-gradient(180deg, rgba(15, 15, 15, 0.9), rgba(15, 15, 15, 0));
}

body.dark-theme .pan-hint--bottom {
    background: linear-gradient(0deg, rgba(15, 15, 15, 0.9), rgba(15, 15, 15, 0));
}

/* Запрет выделения и grab курсор только на ДЕСКТОПЕ */
@media (min-width: 1025px) {
    html, body {
        user-select: none;
        -webkit-user-select: none;
        cursor: grab;
    }

    body.grabbing {
        cursor: grabbing;
    }
}

/* Разрешаем выделение ТОЛЬКО в текстовых блоках */
#element-info,
#element-title,
.group-content,
.search-results {
    user-select: text;
    -webkit-user-select: text;
    cursor: auto;
}

/* Скролл-контейнеры должны явно менять курсор */
.solubility-wrapper {
    cursor: grab;
    overflow: auto;
}

/* Мобильные устройства - скрываем скроллбары для более чистого UX */
@media (max-width: 768px), (pointer: coarse) {
    .solubility-wrapper,
    .periodic-table-container {
        scrollbar-width: none;
    }

    .solubility-wrapper::-webkit-scrollbar,
    .periodic-table-container::-webkit-scrollbar {
        display: none;
    }
}

.solubility-wrapper:active {
    cursor: grabbing;
}

@media (max-width: 1024px) {
    .periodic-table-container {
      justify-content: center !important;
      align-items: center !important;
      transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1), 
                  height 0.3s cubic-bezier(0.4, 0.0, 0.2, 1) !important;
      height: 100vh !important;
      overflow-y: auto !important;
    }
    
    #mobile-table-wrapper {
      align-items: flex-start !important;
      transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1) !important;
      margin-top: 0 !important;
      margin-bottom: 0 !important;
    }
    
    body.scroll-locked .periodic-table-container {
      transition: none !important;
    }
}

@media (max-width: 1024px) {
    body {
        overflow-y: hidden !important;
    }
    .periodic-table-container {
        overflow-y: hidden !important;
    }

    body.calc-active .periodic-table-container,
    body.balancer-active .periodic-table-container {
        overflow: visible !important;
    }
}

@media (max-width: 1024px) {
    html, body {
      overflow-y: hidden !important;
      overflow-x: auto !important;
      height: 100% !important;
      touch-action: pan-x !important; /* Разрешаем только горизонтальный скролл */
    }
    
    /* Для контейнеров с горизонтальным скроллом */
    .periodic-table-container,
    .solubility-wrapper {
      touch-action: pan-x !important;
      -webkit-overflow-scrolling: touch !important;
    }
  }

/* === ГОРИЗОНТАЛЬНАЯ ОРИЕНТАЦИЯ (LANDSCAPE) === */
@media (max-width: 768px) and (orientation: landscape) {
    /* Основной контейнер - оптимизация под широкий экран */
    .periodic-table-container {
      justify-content: flex-start !important;
      padding-left: 10px !important;
      padding-right: 10px !important;
    }
    
    /* Таблица растворимости - адаптация под горизонтальную ориентацию */
    #solubility-modal .modal-content {
      max-height: 90vh !important;
      height: 90vh !important;
    }

    /* Модалка "Реакции" - размер как у таблицы растворимости */
    #reactions-modal .modal-content {
      max-height: 90vh !important;
      height: 90vh !important;
    }    
    /* Панель уравнителя - оптимальное расположение */
    .balancer-panel {
      width: 90% !important;
      left: 5% !important;
      right: 5% !important;
      bottom: env(safe-area-inset-bottom, 10px) !important;
      max-height: 35vh !important;
      border-radius: 15px 15px 0 0 !important;
    }
    
    /* FAB-меню - перемещение для лучшего доступа */
    .fab-container {
      bottom: env(safe-area-inset-bottom, 15px) !important;
      right: 15px !important;
      left: auto !important;
      flex-direction: column !important;
    }
    
    /* Калькулятор - полная ширина */
    .calc-panel {
      width: 95% !important;
      left: 2.5% !important;
      right: 2.5% !important;
      bottom: calc(env(safe-area-inset-bottom, 10px) + 10px) !important;
      max-height: 35vh !important;
      border-radius: 15px 15px 0 0 !important;
    }
    
    /* Отступы для безопасной области */
    body {
      padding-bottom: env(safe-area-inset-bottom, 0px) !important;
    }
  }

/* Добавить после существующих медиа-запросов */
@media (max-width: 768px) and (orientation: landscape) {
    #mobile-table-wrapper {
      transform: scale(0.85) !important;
      transform-origin: top left !important;
      margin-top: -20px !important;
    }
    
    .periodic-table-container {
      transform: none !important;
    }
    
    /* Уменьшить отступы для экономии места */
    .table-wrapper {
      margin-bottom: 5px !important;
    }
    
    /* Скрыть не критичные элементы в горизонтальном режиме */
    .below-table-content {
      display: none !important;
    }
  }
